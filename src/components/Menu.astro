---
import { t } from "@locales";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
  lang: string;
  currentPath: string;
}

const { lang, currentPath } = Astro.props;

const otherLang = lang === "es" ? "en" : "es";
// Extract the path without the language prefix
const pathWithoutLang = currentPath.replace(`/${lang}/`, "/").replace(`/${lang}`, "/");
const otherLangPath = getRelativeLocaleUrl(otherLang, pathWithoutLang === "/" ? "" : pathWithoutLang);

const homeUrl = getRelativeLocaleUrl(lang, "");
const aboutUrl = getRelativeLocaleUrl(lang, "about");
---

<nav class="menu">
  <div class="menu__left">
    <div class="language-switcher">
      <a href={otherLangPath}>
        <img
          src={`/images/flags/${otherLang === "es" ? "es" : "uk"}.svg`}
          alt={t(lang, otherLang === "es" ? "menu.toSpanish" : "menu.toEnglish")}
          title={t(lang, otherLang === "es" ? "menu.toSpanish" : "menu.toEnglish")}
        />
      </a>
    </div>
    <div class="theme-switcher">
      <input type="checkbox" class="theme-switcher__selector" id="selector" />
      <label for="selector">
        <div class="theme-switcher__selector__image" title={t(lang, "menu.switchTheme")}></div>
      </label>
    </div>
  </div>
  <div class="menu__right">
    <ul class="navigation">
      <li class="navigation__link">
        <a
          href={homeUrl}
          class:list={[{ "navigation__link--active": currentPath === homeUrl || currentPath === `${homeUrl}/` }]}
        >
          {t(lang, "pages.home")}
        </a>
      </li>
      <li class="navigation__link">
        <a
          href={aboutUrl}
          class:list={[{ "navigation__link--active": currentPath === aboutUrl || currentPath === `${aboutUrl}/` }]}
        >
          {t(lang, "pages.about")}
        </a>
      </li>
    </ul>
  </div>
</nav>

<script>
  import { initTheme } from "@scripts/theme";

  // Initialize theme on page load and after view transitions
  document.addEventListener("astro:page-load", () => {
    initTheme();
  });
</script>
