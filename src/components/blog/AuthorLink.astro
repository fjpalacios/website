---
/**
 * AuthorLink Component
 * Creates internal links to author pages within MDX content
 *
 * Usage in MDX:
 * <AuthorLink name="Stephen King" />
 *
 * Props:
 * - name: Author name (must match exactly, case-sensitive)
 */

import { findAuthor, generateAuthorUrl } from "@utils/authorLinkHelpers";
import { getCollection } from "astro:content";

import { getLocaleFromPath } from "@/locales";

interface Props {
  name: string;
}

const { name } = Astro.props;

// Get current language from URL
const currentPath = Astro.url.pathname;
const currentLang = getLocaleFromPath(currentPath) as "es" | "en";

// Query all authors and find the matching one
const allAuthors = await getCollection("authors");
const author = findAuthor(allAuthors, name);

// Generate URL if author exists
const authorUrl = generateAuthorUrl(author, currentLang);
---

{authorUrl ? <a href={authorUrl}>{name}</a> : <Fragment>{name}</Fragment>}
