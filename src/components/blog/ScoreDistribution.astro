---
/**
 * ScoreDistribution Component
 * Displays book score distribution with star/heart icons
 */

import Icon from "@components/Icon.astro";

import type { LanguageKey } from "@/config/languages";
import { getTranslations } from "@/locales";
import type { ScoreDistribution } from "@/utils/blog/book-stats";

interface Props {
  distribution: ScoreDistribution;
  lang: LanguageKey;
}

const { distribution, lang } = Astro.props;

const t = getTranslations(lang);

// Score entries in display order
const scoreEntries = [
  { key: "fav" as const, count: 5, isFavorite: true, label: "Favoritos" },
  { key: 5 as const, count: 5, isFavorite: false, label: "5 estrellas" },
  { key: 4 as const, count: 4, isFavorite: false, label: "4 estrellas" },
  { key: 3 as const, count: 3, isFavorite: false, label: "3 estrellas" },
  { key: 2 as const, count: 2, isFavorite: false, label: "2 estrellas" },
  { key: 1 as const, count: 1, isFavorite: false, label: "1 estrella" },
];
---

<section class="book-stats-container__section">
  <h2 class="book-stats-container__section-title">{t.bookStats.scoreDistribution}</h2>

  <div class="score-distribution">
    {
      scoreEntries.map(({ key, count, isFavorite, label }) => {
        const bookCount = distribution[key];
        const booksText = bookCount === 1 ? "libro" : "libros";

        return (
          <div class="score-distribution__card">
            <div
              class={`score-distribution__stars ${isFavorite ? "score-distribution__stars--favorite" : ""}`}
              aria-label={label}
            >
              {Array.from({ length: count }).map(() => (
                <Icon name={isFavorite ? "heart" : "star"} class="score-distribution__icon" size="lg" filled={true} />
              ))}
            </div>
            <div class="score-distribution__label">{label}</div>
            <div class="score-distribution__count">
              {bookCount} {booksText}
            </div>
          </div>
        );
      })
    }
  </div>
</section>
