---
import TaxonomyList from "@components/TaxonomyList.astro";
import Title from "@components/Title.astro";
import Layout from "@layouts/Layout.astro";
import { t } from "@locales";

import contactEn from "@/content/static/contact/en.json";
import { TAXONOMY_CONFIGS, getTaxonomyItemsWithCount, hasTargetContent } from "@/utils/taxonomyPages";

const lang = "en";
const config = TAXONOMY_CONFIGS.courses;

const itemsData = await getTaxonomyItemsWithCount(config, lang);
const itemsWithContent = itemsData
  .filter(({ count }) => count > 0)
  .sort((a, b) => a.item.data.name.localeCompare(b.item.data.name));

const hasTargetLangContent = await hasTargetContent(config, "es");
const pageTitle = `ðŸŽ“ ${t(lang, "pages.courses")}`;
const pageDescription = t(lang, "allCourses");
---

<Layout
  lang={lang}
  title={pageTitle}
  description={pageDescription}
  contact={contactEn}
  hasTargetContent={hasTargetLangContent}
>
  <Title title={pageTitle} />

  <div data-pagefind-ignore>
    {
      itemsWithContent.length > 0 ? (
        <TaxonomyList
          items={itemsWithContent}
          title={t(lang, "allCourses")}
          lang={lang}
          routeKey="courses"
          slugField="course_slug"
        />
      ) : (
        <div class="empty-state">
          <p>{t(lang, "emptyState.courses")}</p>
        </div>
      )
    }
  </div>
</Layout>

<style lang="scss">
  @use "@/styles/mixins" as *;
  @use "@/styles/variables" as *;

  .empty-state {
    grid-column: span 12;
    text-align: center;
    padding: 4rem 2rem;
    color: $cursive-color;
  }
</style>
