---
import { getCollection } from "astro:content";

// Test querying all collections
const books = await getCollection("books");
const posts = await getCollection("posts");
const tutorials = await getCollection("tutorials");
const authors = await getCollection("authors");
const categories = await getCollection("categories");
const publishers = await getCollection("publishers");
const series = await getCollection("series");
const challenges = await getCollection("challenges");
const courses = await getCollection("courses");
const genres = await getCollection("genres");
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Content Collections Test</title>
    <style>
      body {
        font-family:
          system-ui,
          -apple-system,
          sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        background: #0f172a;
        color: #e2e8f0;
      }
      h1 {
        color: #38bdf8;
        border-bottom: 2px solid #38bdf8;
        padding-bottom: 0.5rem;
      }
      h2 {
        color: #22d3ee;
        margin-top: 2rem;
      }
      .collection-info {
        background: #1e293b;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
        border-left: 4px solid #38bdf8;
      }
      .count {
        color: #4ade80;
        font-weight: bold;
        font-size: 1.2rem;
      }
      .item {
        background: #334155;
        padding: 0.5rem 1rem;
        margin: 0.5rem 0;
        border-radius: 4px;
        font-family: "Courier New", monospace;
        font-size: 0.9rem;
      }
      .success {
        color: #4ade80;
      }
      .warning {
        color: #fbbf24;
      }
    </style>
  </head>
  <body>
    <h1>üìö Content Collections Test Page</h1>
    <p>This page tests that all 10 content collections are properly configured and can be queried.</p>

    <h2>Primary Content Collections (MDX)</h2>

    <div class="collection-info">
      <h3>üìñ Books</h3>
      <p class="count">{books.length} item(s)</p>
      {
        books.map((book) => (
          <div class="item">
            <strong>{book.data.title}</strong> by {book.data.author} ({book.data.language})
          </div>
        ))
      }
      {books.length === 0 && <p class="warning">No books found</p>}
    </div>

    <div class="collection-info">
      <h3>üìù Posts</h3>
      <p class="count">{posts.length} item(s)</p>
      {
        posts.map((post) => (
          <div class="item">
            <strong>{post.data.title}</strong> ({post.data.language})
          </div>
        ))
      }
      {posts.length === 0 && <p class="warning">No posts found</p>}
    </div>

    <div class="collection-info">
      <h3>üéì Tutorials</h3>
      <p class="count">{tutorials.length} item(s)</p>
      {
        tutorials.map((tutorial) => (
          <div class="item">
            <strong>{tutorial.data.title}</strong> - {tutorial.data.difficulty} ({tutorial.data.language})
          </div>
        ))
      }
      {tutorials.length === 0 && <p class="warning">No tutorials found</p>}
    </div>

    <h2>Taxonomy Collections (JSON)</h2>

    <div class="collection-info">
      <h3>üë§ Authors</h3>
      <p class="count">{authors.length} item(s)</p>
      {
        authors.map((author) => (
          <div class="item">
            <strong>{author.data.name}</strong> ({author.data.language})
          </div>
        ))
      }
      {authors.length === 0 && <p class="warning">No authors found</p>}
    </div>

    <div class="collection-info">
      <h3>üè∑Ô∏è Categories</h3>
      <p class="count">{categories.length} item(s)</p>
      {
        categories.map((category) => (
          <div class="item">
            <strong>{category.data.name}</strong> ({category.data.language}) - Order: {category.data.order}
          </div>
        ))
      }
      {categories.length === 0 && <p class="warning">No categories found</p>}
    </div>

    <div class="collection-info">
      <h3>üè¢ Publishers</h3>
      <p class="count">{publishers.length} item(s)</p>
      {
        publishers.map((publisher) => (
          <div class="item">
            <strong>{publisher.data.name}</strong> - {publisher.data.country} ({publisher.data.language})
          </div>
        ))
      }
      {publishers.length === 0 && <p class="warning">No publishers found</p>}
    </div>

    <div class="collection-info">
      <h3>üìö Series</h3>
      <p class="count">{series.length} item(s)</p>
      {
        series.map((s) => (
          <div class="item">
            <strong>{s.data.name}</strong> by {s.data.author} ({s.data.language})
          </div>
        ))
      }
      {series.length === 0 && <p class="warning">No series found</p>}
    </div>

    <div class="collection-info">
      <h3>üéØ Challenges</h3>
      <p class="count">{challenges.length} item(s)</p>
      {
        challenges.map((challenge) => (
          <div class="item">
            <strong>{challenge.data.name}</strong> - Goal: {challenge.data.goal} books ({challenge.data.language})
          </div>
        ))
      }
      {challenges.length === 0 && <p class="warning">No challenges found</p>}
    </div>

    <div class="collection-info">
      <h3>üéì Courses</h3>
      <p class="count">{courses.length} item(s)</p>
      {
        courses.map((course) => (
          <div class="item">
            <strong>{course.data.name}</strong> - {course.data.difficulty}, {course.data.estimated_duration}min (
            {course.data.language})
          </div>
        ))
      }
      {courses.length === 0 && <p class="warning">No courses found</p>}
    </div>

    <div class="collection-info">
      <h3>üé≠ Genres</h3>
      <p class="count">{genres.length} item(s)</p>
      {
        genres.map((genre) => (
          <div class="item">
            <strong>{genre.data.name}</strong>
            {genre.data.parent && ` (child of: ${genre.data.parent})`} ({genre.data.language})
          </div>
        ))
      }
      {genres.length === 0 && <p class="warning">No genres found</p>}
    </div>

    <div style="margin-top: 3rem; padding: 1rem; background: #065f46; border-radius: 8px;">
      <h2 class="success">‚úÖ All Collections Working!</h2>
      <p>All 10 content collections are properly configured and accessible via Astro's getCollection() API.</p>
    </div>
  </body>
</html>
